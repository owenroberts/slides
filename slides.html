<!DOCTYPE html>
<html>
<head>
  <title>cell test</title>
  <style>
    body { margin:0;}
    canvas {
      overflow: hidden;
      position:fixed;
    }

  </style>
</head>
<body>
  
  <script src="p5.min.js"></script>
  <script>

    function makeGameOfLife() {
      limits.lonelylimit = 2;
      limits.lonelyaction = 0;
    }

    function makeBars() {
      limits.lonelylimit = 1;
      limits.lonelyaction = 1;
    }

    var w;
    var columns, rows, board;
    var fps = 0.5;
    var alive, born, died, none;
    
    var limits = {
      lonelylimit:1,
      lonelyaction:1
    }
    var animationBreak = false;

    var lerper = 0.001;
    var lerpinc = 0.005;

    function setup() {
      createCanvas(windowWidth, windowHeight);
      noStroke();
      frameRate(30);

      w = windowWidth / 20;
      columns = Math.floor(windowWidth/w);
      rows = Math.floor(windowHeight/w);
     // board = Array(columns);
      
      alive = color("red"); // state == 1, prevState == 1
      born  = color("green"); // state == 1, prevState == 0
      died  = color("blue"); // state == 0, prevState == 1
      nothing  = color("green");   // state == 0, prevState == 0
      console.log(nothing.levels[3]);

      for (var i = 0; i < columns; i++){
        board[i] = Array(rows);
      }
      
      //init();
      //display();
      colorMode(RGB, 255);
    }

    function draw() {
      console.log(nothing.levels[3]);
      if (lerper < 1) lerper += lerpinc;
      background("white");
      //display();
      colorTest();
      //if (!animationBreak) setTimeout(function(){requestAnimationFrame(loop)}, 1000/fps);
    }

    function display() {          
      for (var x = 0; x < columns; x++) {
        for (var y = 0; y < rows; y++) {
          if ((board[x][y].state) && (board[x][y].prev)) {
            fill(alive);
            rect(x*w, y*w, w, w);
          } else if ((board[x][y].state)) {
            //var lc = lerpColor( white, born, lerper );
            //console.log(lc.levels[0], lc.levels[1], lc.levels[2], lc.levels[3]);
            //console.log(lerper.toFixed(2));
            fill(born);
            rect(x*w, y*w, w, w);
          } else if ((board[x][y].prev) && !(board[x][y].state)) {
            console.log(lerper);
            var newcolor = lerpColor(alive, died, lerper.toFixed[2]);

            fill(newcolor);
            rect(x*w, y*w, w, w);
          } else {
            fill(white);
            rect(x*w, y*w, w, w);
          }          
        }
      }
    }

    function colorTest() {
      stroke("red");
      
    }
  
    function Cell(state) { 
      this.state = state;
      this.prev = state;
      this.savePrevious = function() { this.prev = this.state; }
      this.newState = function(num) { this.state = num; }      
    }

    function init() {
      for (var x = 0; x < columns; x++) {
        for (var y = 0; y < rows; y++) {
          board[x][y] = new Cell(Math.round(Math.random()));
        }
      }
    }
    
    function generate() {
      lerper = 0;
      for (var i = 0; i < columns; i++){
        for (var j = 0; j < rows; j++){
          board[i][j].savePrevious();
        }
      }
      
      for (var x = 1; x < columns - 1; x++) {
        for (var y = 1; y < rows - 1; y++) {
          var n = 0;
          for (var i = -1; i <= 1; i++) {
            for (var j = -1; j <= 1; j++) {
              n += board[x+i][y+j].prev;
            }
          }
          n -= board[x][y].prev; 
          //lonely 
          if ((board[x][y].state == 1) && (n < limits.lonelylimit)) {
            board[x][y].newState(limits.lonelyaction);
          } 
          //overpopulated
          else if ((board[x][y].state == 1) && (n > 3)) {
            board[x][y].newState(0);
          } 
          //just right
          else if ((board[x][y].state == 0) && (n == 3)) {
            board[x][y].newState(1);
          } 
        }
      }
    }



    function stop() {
      animationBreak = true;
    }
    function start() {
      animationBreak = false;
    }
    function keyPressed() {
      if (keyCode == LEFT_ARROW || keyCode == UP_ARROW 
          || keyCode == DOWN_ARROW || keyCode == RIGHT_ARROW) {
        lerper=0.001;//generate();

      }
    }
  </script>
  
  
  
</body>
</html>